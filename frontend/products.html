<!DOCTYPE html>
<html class="light" lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Products - SEIRA</title>

  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#333333",
            "background-light": "#F9F9F9",
            "background-dark": "#101c22",
          },
          fontFamily: {
            display: ["Plus Jakarta Sans", "Noto Sans", "sans-serif"]
          }
        }
      }
    };
  </script>

  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }
  </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-[#212121] dark:text-gray-200">

<!-- NAVBAR -->
<header class="sticky top-0 z-50 flex w-full justify-center border-b border-gray-200 dark:border-gray-700 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm">
  <div class="flex items-center gap-4 px-4 sm:px-10 py-3 w-full max-w-7xl">
    <div class="flex items-center gap-6">
      <a class="text-lg font-black uppercase tracking-[0.25em] relative inline-flex items-center text-[#111618]" href="/">
        <span class="inline-flex px-1.5 py-0.5 bg-[#111618] text-white rounded-sm">SE</span>IRA
        <span class="absolute -bottom-1 -right-6 text-xs text-gray-500">.com</span>
      </a>

      <nav class="hidden lg:flex items-center gap-6 text-sm uppercase font-semibold">
        <a href="/products?category=men" class="hover:text-primary">Men</a>
        <a href="/products?category=women" class="hover:text-primary">Women</a>
        <a href="/products?category=kids" class="hover:text-primary">Kids</a>
        <a href="#" class="hover:text-primary">Shop</a>
        <a href="/products" class="hover:text-primary">GENZ</a>
      </nav>
    </div>

    <div class="hidden md:flex flex-1 justify-center">
      <label class="flex w-full max-w-xl h-10">
        <div class="flex items-center bg-gray-200 dark:bg-gray-800 pl-3 rounded-l-lg">
          <span class="material-symbols-outlined text-gray-500">search</span>
        </div>
        <input id="searchInput" class="flex flex-1 bg-gray-200 dark:bg-gray-800 px-4 rounded-r-lg outline-none" placeholder="Search for products..."/>
      </label>
    </div>

    <div class="flex items-center gap-6 text-xs font-semibold uppercase">
      <a href="/wishlist" class="flex flex-col items-center">
        <span class="material-symbols-outlined">favorite</span>
        Wishlist
      </a>

      <a href="/cart" class="relative flex flex-col items-center">
        <span class="material-symbols-outlined">shopping_bag</span>
        Bag
        <span class="absolute top-0 right-[-6px] bg-primary text-white text-[10px] px-1 rounded-full" data-cart-count>0</span>
      </a>
    </div>
  </div>
</header>

<!-- MAIN CONTENT -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

  <!-- Breadcrumbs -->
  <div class="flex gap-2 text-sm text-gray-500 dark:text-gray-400 mb-6">
    <a href="/">Home</a>
    <span>/</span>
    <span class="text-[#212121] dark:text-white">Products</span>
  </div>

  <h1 class="text-4xl font-black mb-8">Products</h1>

  <!-- Product Grid -->
  <div id="productGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6">
    <!-- JS will insert products -->
  </div>
</main>

<!-- FOOTER -->

<script>
const API_BASE = "https://app-xe51.onrender.com/api";

async function loadProducts() {
  const params = new URLSearchParams(window.location.search);
  const category = params.get("category");
  const search = params.get("search");

  let url = `${API_BASE}/products`;
  if (category) url += `?category=${encodeURIComponent(category)}`;
  if (search) url += `${category ? "&" : "?"}search=${encodeURIComponent(search)}`;

  const res = await fetch(url);
  const products = await res.json();

  const grid = document.getElementById("productGrid");
  grid.innerHTML = "";

  products.forEach(product => {
    const card = document.createElement("div");
    card.className = "cursor-pointer group";

    card.innerHTML = `
      <div class="w-full aspect-square rounded-lg overflow-hidden bg-gray-100">
        <img src="${product.image}" class="w-full h-full object-cover group-hover:scale-105 transition"/>
      </div>
      <h3 class="mt-3 font-semibold">${product.name}</h3>
      <p class="text-primary font-bold">$${product.price}</p>
    `;

    card.addEventListener("click", () => {
      localStorage.setItem("selectedProduct", JSON.stringify({
        id: product.id,
        title: product.name,
        price: "$" + product.price,
        description: product.description,
        image: product.image,
        gallery: product.images || [product.image]
      }));
      window.location.href = "/product";
    });

    grid.appendChild(card);
  });
}

document.addEventListener("DOMContentLoaded", loadProducts);
</script>

<script src="/static/js/cart-indicator.js"></script>
<script src="/static/js/wishlist.js"></script>
<script src="/static/js/ai-search-modal.js"></script>
<script src="/static/js/shop-modal.js"></script>

</body>
</html>
